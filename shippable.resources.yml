resources:
# add infrastructure resources

# add env - GKE cluster TEST
  - name: abbott-platform-info-botapp-cluster-gke
    type: cluster
    integration: gcr-ciandt-cognitive-sandbox # replace with your GKE integration name
    pointer:
      sourceName : "abbott-platform-info-botapp" # replace with your GKE cluster name
      region: us-central1-a
      namespace: "ciandt-cognitive-sandbox" # replace with your Google Cloud project name
    flags:
      - gke-loadbalancer

################################

# Docker Image
  - name: abbott-platform-info-botapp-img-gke
    type: image
    integration: gcr-ciandt-cognitive-sandbox # replace with your GCR integration name
    pointer:
      sourceName: gcr.io/ciandt-cognitive-sandbox/abbott-platform-info-botapp # replace namespace name with your Google Cloud project name
      isPull: false
    seed:
      versionName: master-ci-shippable.1
    flags:
      - gke-loadbalancer

################################

# TEST resources

# Docker Image Options
  - name: abbott-platform-info-botapp-img-options-gke-test
    type: dockerOptions
    version:
      memory: 64
      cpuShares: 128
      portMappings:
        - 80:80
      publishAllPorts : true
      labels:   # these labels will be used by the loadBalancer resource
        app: abbott-platform-info-botapp-node-gcr-deploy-gke-loadbalancer
        env: test
    flags:
      - gke-loadbalancer

# env vars for Test
  - name: abbott-platform-info-botapp-params-gke-test
    type: params
    version:
      params:
        ENVIRONMENT: "TEST"
        PORT: 80
        ABBOTT_LOG_LEVEL: "info"
        NLP_APIAI_TOKEN: "$NLP_APIAI_TOKEN"
    flags:
      - gke-loadbalancer

# GKE service/load balancer for TEST
  - name: abbott-platform-info-botapp-service-test
    type: loadBalancer
    integration: gcr-ciandt-cognitive-sandbox # replace with your GKE integration name
    pointer:
      sourceName: "abbott-platform-info-botapp-service-test"
      method: LoadBalancer
      clusterName: abbott-platform-info-botapp # replace with your GKE cluster name
      region: "us-central1-a" # replace with your GKE cluster region
      namespace: ciandt-cognitive-sandbox # replace with your Google Cloud project name
    version:
      ports:
        - name: public
          protocol: TCP
          port: 80
      selector:  # these must match labels set on your image (see dockerOptions)
        app: abbott-platform-info-botapp-node-gcr-deploy-gke-loadbalancer
        env: test
    flags:
      - gke-loadbalancer

################################

# set service version seed
  - name: abbott-platform-info-botapp-version-gke
    type: version
    seed:
      versionName: "1.0.0"
    flags:
      - gke-loadbalancer

################################

# PROD resources

# Docker Image Options
  - name: abbott-platform-info-botapp-img-options-gke-prod
    type: dockerOptions
    version:
      memory: 64
      cpuShares: 128
      labels: # these labels will be used by the loadBalancer resource
        app: abbott-platform-info-botapp-gke-loadbalancer
        env: prod
    flags:
      - gke-loadbalancer

# env vars for Prod
  - name: abbott-platform-info-botapp-params-gke-prod
    type: params
    version:
      params:
        ENVIRONMENT: "PROD"
        PORT: 80
        ABBOTT_LOG_LEVEL: "error"
        NLP_APIAI_TOKEN: "$NLP_APIAI_TOKEN"
    flags:
      - gke-loadbalancer

# GKE service/load balancer for PROD 
  - name: abbott-platform-info-botapp-service-prod
    type: loadBalancer
    integration: gcr-ciandt-cognitive-sandbox # replace with your GKE integration name
    pointer:
      sourceName: "abbott-platform-info-botapp-service-prod"
      method: LoadBalancer
      clusterName: abbott-platform-info-botapp # replace with your GKE cluster name
      region: "us-central1-a" # replace with your GKE cluster region
      namespace: ciandt-cognitive-sandbox # replace with your Google Cloud project name
    version:
      ports:
        - name: public
          protocol: TCP
          port: 80
      selector:   # these must match labels set on your image (see dockerOptions)
        app: abbott-platform-info-botapp-gke-loadbalancer
        env: prod
    flags:
      - gke-loadbalancer

# PROD replicas
  - name: abbott-platform-info-botapp-replicas-gke-prod
    type: replicas
    version:
      count: 1
    flags:
      - gke-loadbalancer

# ################################